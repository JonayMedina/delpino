(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{233:function(e,r,s){"use strict";s.r(r);var t=s(6);function o(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,t)}return s}function a(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?o(Object(s),!0).forEach((function(r){n(e,r,s[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(s,r))}))}return e}function n(e,r,s){return r in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}var i={data:function(){return{user:{date:null},eCustomer:0,errListC:[],messages:"",snackbar:!1,multiline:!0,color:"general",code:"white",checked:!1,password:"",password_confirmation:"",showPassword1:!1,profileErrors:{},saving:!1,savingModal:!1,menu:!1,passErrors:[],errorsList:[],dialog:!1,rules:{required:function(e){return!!e||"Requerido"},counter:function(e){return e.length>=8||"Mínimo 8 caracteres"}}}},watch:{menu:function(e){var r=this;e&&setTimeout((function(){return r.$refs.picker.activePicker="YEAR"}))}},computed:a(a({},Object(t.c)(["barImage"])),{},{passwordConfirmationRule:function(){return this.password===this.password_confirmation||"Las Contraseñas deben Coincidir"},currentUser:function(){return this.$store.getters.currentUser},progress:function(){return Math.min(100,12.5*this.password.length)},colorp:function(){return["error","warning","success"][Math.floor(this.progress/40)]},progress2:function(){return Math.min(100,12.5*this.password_confirmation.length)},colorpc:function(){return["error","warning","success"][Math.floor(this.progress2/40)]}}),methods:{save:function(e){this.$refs.menu.save(e)},me:function(){var e=this;axios.post("/api/auth/me").then((function(r){e.user=r.data.user})).catch((function(e){console.log(e)}))},updateProfile:function(){var e=this;e.validateCustomer()||(e.saving=!0,axios.put("/api/user/update-own-data",e.user).then((function(r){e.messages=r.data.message,e.snackbar=!0,e.me()})).catch((function(r){422==r.response.status?e.profileErrors=r.response.data.errors:(e.messages=r.response.error,e.snackbar=!0)})).finally((function(){return e.saving=!1})))},validateCustomer:function(){var e=this;return e.eCustomer=0,e.errListC=[],e.user.name||e.errListC.push("Por favor ingrese nombre completo"),e.user.email||e.errListC.push("Ingrese un email valido"),e.email&&e.errListC.push("E-mail Registrado, por favor introduzca otro"),4!=e.currentUser||e.user.phone||e.errListC.push("Ingrese numero de Telefono"),e.errListC.length&&(e.eCustomer=1),e.eCustomer},updatePassword:function(){var e=this;e.valpass()||(e.savingModal=!0,axios.put("/api/user/change-password",{password:e.password,password_confirmation:e.password_confirmation}).then((function(r){e.password="",e.password_confirmation="",e.dialog=!1,e.messages="Contraseña Cambiada ",e.snackbar=!0})).catch((function(r){422==r.response.status?e.resetErrors=r.response.data.error:(e.messages="Algo ha ocurrido, intente de Nuevo",e.snackbar=!0,console.log(r))})).finally((function(){return e.savingModal=!1})))},valpass:function(){var e=this,r=0;return e.errorsList=[],(!e.password||e.password.length<6)&&(e.errorsList.push("Ingrese Contraseña igual o mayor a 6 Caracteres"),r+=1),(!e.password_confirmation||e.password_confirmation.length<6)&&(e.errorsList.push("Ingrese Confirmación de Contraseña igual o mayor a 6 Caracteres"),r+=1),e.password!=e.password_confirmation&&(e.errorsList.push("Su Contraseña y Confirmación de Contraseña deben ser Iguales iguales"),r+=1),r}},mounted:function(){this.me()}},c=s(0),l=Object(c.a)(i,(function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("v-container",{attrs:{id:"user-profile",fluid:"",tag:"section"}},[s("v-row",{attrs:{justify:"center"}},[s("v-col",{attrs:{cols:"12",md:"8"}},[s("base-material-card",{scopedSlots:e._u([{key:"heading",fn:function(){return[s("div",{staticClass:"display-2 font-weight-light"},[e._v("\n              Editar su Perfil\n            ")]),e._v(" "),s("div",{staticClass:"subtitle-1 font-weight-light"},[e._v("\n              Complete los Campos\n            ")])]},proxy:!0}])},[e.profileErrors?s("error-component",{attrs:{errors:e.profileErrors}}):e._e(),e._v(" "),e._v(" "),s("v-form",[s("v-container",{staticClass:"py-0"},[s("v-row",[s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-text-field",{staticClass:"purple-input",attrs:{label:"Nombre Completo",type:"text",required:""},model:{value:e.user.name,callback:function(r){e.$set(e.user,"name",r)},expression:"user.name"}})],1),e._v(" "),s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-text-field",{staticClass:"purple-input",attrs:{label:"Email"},model:{value:e.user.email,callback:function(r){e.$set(e.user,"email",r)},expression:"user.email"}})],1),e._v(" "),s("v-col",{directives:[{name:"show",rawName:"v-show",value:4==e.currentUser.role,expression:"currentUser.role ==4"}],attrs:{cols:"12",md:"4"}},[s("v-text-field",{staticClass:"purple-input",attrs:{label:"Telefono",type:"number"},model:{value:e.user.phone,callback:function(r){e.$set(e.user,"phone",r)},expression:"user.phone"}})],1),e._v(" "),s("v-col",{directives:[{name:"show",rawName:"v-show",value:4==e.currentUser.role,expression:"currentUser.role ==4"}],attrs:{cols:"12",md:"4"}},[s("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(r){var t=r.on,o=r.attrs;return[s("v-text-field",e._g(e._b({attrs:{label:"Fecha de Nacimiento","prepend-icon":"mdi-calendar-account",readonly:""},model:{value:e.user.birthdate,callback:function(r){e.$set(e.user,"birthdate",r)},expression:"user.birthdate"}},"v-text-field",o,!1),t))]}}]),model:{value:e.menu,callback:function(r){e.menu=r},expression:"menu"}},[e._v(" "),s("v-date-picker",{ref:"picker",attrs:{max:(new Date).toISOString().substr(0,10),min:"1950-01-01"},on:{change:e.save},model:{value:e.user.birthdate,callback:function(r){e.$set(e.user,"birthdate",r)},expression:"user.birthdate"}})],1)],1),e._v(" "),s("v-col",{staticClass:"text-right",attrs:{cols:"12"}},[s("v-row",[s("v-col",{staticClass:"px-0 d-flex justify-start"},[s("v-btn",{staticClass:"mr-0",attrs:{text:""},on:{click:function(r){e.dialog=!0}}},[e._v("\n                            Cambiar Contraseña\n                        ")])],1),e._v(" "),s("v-col",{staticClass:"d-flex justify-end"},[s("v-btn",{staticClass:"mr-0",attrs:{color:"success",loading:e.saving},on:{click:function(r){return e.updateProfile()}}},[e._v("\n                            Actualizar Perfil\n                        ")])],1)],1)],1)],1)],1)],1)],1)],1)],1),e._v(" "),s("v-row",{staticClass:"mx-2"},[s("v-container",{attrs:{"grid-list-xs":""}},[s("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(r){e.dialog=r},expression:"dialog"}},[s("v-card",{staticClass:"elevation-6"},[e.passErrors?s("error-component",{attrs:{errors:e.passErrors}}):e._e(),e._v(" "),s("v-toolbar",{attrs:{color:"general"}},[s("v-toolbar-title",[e._v("Ingrese Su nueva Contraseña")])],1),e._v(" "),s("v-card-text",[s("v-form",[s("v-text-field",{ref:"password",attrs:{rules:[e.rules.required,e.rules.counter],"prepend-icon":e.showPassword1?"mdi-eye-off":"mdi-eye",label:"Nueva Contraseña",placeholder:"Igual o mayor a 8 caracteres",type:e.showPassword1?"text":"password",loading:""},on:{"click:prepend":function(r){e.showPassword1=!e.showPassword1}},scopedSlots:e._u([{key:"progress",fn:function(){return[s("v-progress-linear",{attrs:{value:e.progress,color:e.colorp,absolute:"",height:"7"}})]},proxy:!0}]),model:{value:e.password,callback:function(r){e.password=r},expression:"password"}}),e._v(" "),s("v-text-field",{ref:"password_confirmation",attrs:{rules:[e.rules.required,e.rules.counter,e.passwordConfirmationRule],"prepend-icon":e.showPassword1?"mdi-eye-off":"mdi-eye",label:"Confirmación de Contraseña",placeholder:"Igual o mayor a 8 caracteres",type:e.showPassword1?"text":"password",loading:""},on:{"click:prepend":function(r){e.showPassword1=!e.showPassword1}},scopedSlots:e._u([{key:"progress",fn:function(){return[s("v-progress-linear",{attrs:{value:e.progress2,color:e.colorpc,absolute:"",height:"7"}})]},proxy:!0}]),model:{value:e.password_confirmation,callback:function(r){e.password_confirmation=r},expression:"password_confirmation"}})],1),e._v(" "),e.errorsList.length?s("div",e._l(e.errorsList,(function(r){return s("p",{key:r},[s("span",{staticClass:"mb-3 red--text text--lighten-1"},[s("v-icon",{attrs:{color:"red","x-small":""}},[e._v("mdi mdi-information-outline")]),e._v("  "+e._s(r))],1)])})),0):e._e()],1),e._v(" "),s("v-divider",{staticClass:"mt-5"}),e._v(" "),s("v-card-actions",[s("v-btn",{staticClass:"mr-0",attrs:{text:""},on:{click:function(r){e.dialog=!1}}},[e._v("\n                            cerrar\n                        ")]),e._v(" "),s("v-spacer"),e._v(" "),s("v-btn",{attrs:{loading:e.savingModal,filled:"",outlined:"","align-center":"","justify-center":"",color:"general",disabled:!e.password||!e.password_confirmation||e.password!=e.password_confirmation||e.password<=5},on:{click:function(r){return e.updatePassword()}}},[e._v("Crear nueva contraseña\n                        ")])],1)],1)],1)],1)],1),e._v(" "),s("v-snackbar",{attrs:{color:e.color,top:!0,"multi-line":e.multiline},scopedSlots:e._u([{key:"action",fn:function(r){var t=r.attrs;return[s("v-btn",e._b({attrs:{color:"black",text:""},on:{click:function(r){e.snackbar=!1}}},"v-btn",t,!1),[e._v("\n                Cerrar\n                ")])]}}]),model:{value:e.snackbar,callback:function(r){e.snackbar=r},expression:"snackbar"}},[e._v("\n            "+e._s(e.messages)+"\n            ")])],1)}),[],!1,null,null,null);r.default=l.exports}}]);